/*							i0.c
 *
 *	Modified Bessel function of order zero
 *
 *
 *
 * SYNOPSIS:
 *
 * double x, y, i0();
 *
 * y = i0( x );
 *
 *
 *
 * DESCRIPTION:
 *
 * Returns modified Bessel function of order zero of the
 * argument.
 *
 * The function is defined as i0(x) = j0( ix ).
 *
 * The range is partitioned into the two intervals [0,8] and
 * (8, infinity).  Chebyshev polynomial expansions are employed
 * in each interval.
 *
 *
 *
 * ACCURACY:
 *
 *                      Relative error:
 * arithmetic   domain     # trials      peak         rms
 *    DEC       0,30         6000       8.2e-17     1.9e-17
 *    IEEE      0,30        30000       5.8e-16     1.4e-16
 *
 */
/*							i0e.c
 *
 *	Modified Bessel function of order zero,
 *	exponentially scaled
 *
 *
 *
 * SYNOPSIS:
 *
 * double x, y, i0e();
 *
 * y = i0e( x );
 *
 *
 *
 * DESCRIPTION:
 *
 * Returns exponentially scaled modified Bessel function
 * of order zero of the argument.
 *
 * The function is defined as i0e(x) = exp(-|x|) j0( ix ).
 *
 *
 *
 * ACCURACY:
 *
 *                      Relative error:
 * arithmetic   domain     # trials      peak         rms
 *    IEEE      0,30        30000       5.4e-16     1.2e-16
 * See i0().
 *
 */

/*							i0.c		*/


/*
 * Cephes Math Library Release 2.8:  June, 2000
 * Copyright 1984, 1987, 2000 by Stephen L. Moshier
 */

#include "mconf.h"

/* Chebyshev coefficients for exp(-x) I0(x)
 * in the interval [0,8].
 *
 * lim(x->0){ exp(-x) I0(x) } = 1.
 */


static unsigned short A[] = {
    0xd0ef,0x2134,0x5cb7,0xbc54,
    0xa589,0x977d,0x3362,0x3c83,
    0xbbb4,0x721e,0x84eb,0xbcb1,
    0x5eba,0x93f6,0xe6d8,0x3cde,
    0xfbeb,0xc297,0x5022,0xbd0a,
    0x2627,0x4b26,0x9b46,0x3d35,
    0x1af0,0x62ee,0x164c,0xbd61,
    0xd324,0xe19b,0xfe2f,0x3d89,
    0x6abc,0x7a94,0xfc95,0xbdb2,
    0x3c10,0xcc74,0x98be,0x3dda,
    0x9556,0x13ae,0xd4fe,0xbe01,
    0xcb34,0xa454,0xd903,0x3e26,
    0x30ab,0x8c0b,0xeaf6,0xbe4b,
    0x6435,0x9d4d,0x3b76,0x3e70,
    0x7f8d,0x8f22,0xec63,0xbe91,
    0xf4ac,0x978c,0xbf24,0x3eb2,
    0x6427,0xcba5,0x866f,0xbed2,
    0x2859,0xbe9a,0x3f58,0x3ef1,
    0x1d5a,0x59c4,0x2b26,0xbf0e,
    0x7cab,0x7410,0xb51b,0x3f28,
    0xeb52,0x1f15,0xe2fd,0xbf42,
    0x100e,0x8a12,0xdc75,0x3f5a,
    0xa849,0x201a,0xb65e,0xbf71,
    0xe3dd,0xf3dd,0x9961,0x3f85,
    0xb6f0,0xf121,0x4e9e,0xbf98,
    0xa32d,0xcea8,0x3e8a,0x3fa9,
    0x06ea,0x342d,0x4b70,0xbfb8,
    0x88c0,0x77ac,0xf7ac,0x3fc5,
    0xcd8d,0xc057,0x7feb,0xbfd3,
    0xa22a,0x9035,0xa84e,0x3fe5,
};


/* Chebyshev coefficients for exp(-x) sqrt(x) I0(x)
 * in the inverted interval [8,infinity].
 *
 * lim(x->inf){ exp(-x) sqrt(x) I0(x) } = 1/sqrt(2pi).
 */



static unsigned short B[] = {
    0x8b19,0x54ca,0xadb7,0xbc60,
    0x9130,0x6611,0x46da,0xbc56,
    0x8421,0x12d9,0xbe18,0x3c89,
    0x41cd,0x0760,0xf3dd,0x3c83,
    0x1fe4,0xabd2,0x600b,0xbcb4,
    0xde38,0xd908,0xaee7,0xbcb8,
    0xfb1f,0xa3ea,0xee7d,0x3cdf,
    0xe6d7,0x9094,0x2a91,0x3cf1,
    0x629a,0x7e65,0x83fe,0xbd05,
    0xbb32,0xcf68,0x5d99,0xbd27,
    0xc545,0x0d5f,0x56ff,0x3d11,
    0xc073,0x6b83,0x1c8c,0x3d5b,
    0x8cec,0xfa26,0x4347,0x3d69,
    0x8d66,0x0317,0x9043,0xbd7f,
    0x7bf2,0x357e,0x0fd7,0xbdad,
    0x7425,0x0839,0x511d,0xbdc1,
    0x004f,0xabe8,0x24fe,0x3daa,
    0x6f75,0xc0f4,0xf9cc,0x3e00,
    0x5b87,0xa922,0x2c64,0x3e2d,
    0xd56d,0x80d6,0x5692,0x3e58,
    0x616e,0xd9cd,0x8007,0x3e8b,
    0xc586,0xc101,0x412b,0x3ec8,
    0x9e52,0x7899,0x0fa3,0x3f12,
    0x9049,0xa2e5,0x998c,0x3f6b,
    0x09cb,0xaca8,0xbe62,0x3fe9
};





extern double chbevl ( double, void *, int );
extern double exp ( double );
extern double sqrt ( double );



double i0(double x)
{
    double y;
    
    if( x < 0 )
        x = -x;
    if( x <= 8.0 )
    {
        y = (x/2.0) - 2.0;
        return( exp(x) * chbevl( y, A, 30 ) );
    }
    
    return(  exp(x) * chbevl( 32.0/x - 2.0, B, 25 ) / sqrt(x) );
    
}




double i0e( double x )
{
    double y;
    
    if( x < 0 )
        x = -x;
    if( x <= 8.0 )
    {
        y = (x/2.0) - 2.0;
        return( chbevl( y, A, 30 ) );
    }
    
    return(  chbevl( 32.0/x - 2.0, B, 25 ) / sqrt(x) );
    
}
